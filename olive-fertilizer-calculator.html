<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Επαγγελματικός Υπολογιστής Λίπανσης Ελιάς | Agronomist Pro</title>
  <!-- 
    Επαγγελματικός Υπολογιστής Λίπανσης Ελιάς | Agronomist Pro
    Copyright (c) 2026 Sotiris G. Paisios
    Διατίθεται υπό την άδεια Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)
    https://creativecommons.org/licenses/by-nc-sa/4.0/
    Απαγορεύεται η εμπορική εκμετάλλευση χωρίς γραπτή άδεια του δημιουργού.
  -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #2c5e2e;
      --primary-dark: #1e4a22;
      --secondary: #4a7c4d;
      --accent: #d4a017;
      --bg: #f8faf8;
      --card-bg: #ffffff;
      --text: #333333;
      --border: #dde2d5;
      --success: #e6f6ff;
      --warning: #fff8e6;
      --error: #ffebee;
      --radius: 12px;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      background: var(--primary);
      color: white;
      padding: 24px 32px;
      border-radius: var(--radius) var(--radius) 0 0;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
      position: relative;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
    }

    h1 {
      font-size: 1.8rem;
      font-weight: 700;
      margin: 0;
    }

    .subtitle {
      font-size: 1rem;
      opacity: 0.9;
      margin-top: 4px;
      font-weight: 400;
    }

    .author-badge {
      position: absolute;
      bottom: 12px;
      right: 32px;
      font-size: 0.85rem;
      background: rgba(255,255,255,0.2);
      padding: 2px 10px;
      border-radius: 20px;
    }

    .card {
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px;
      margin-bottom: 24px;
      border: 1px solid var(--border);
    }

    .section-title {
      font-size: 1.3rem;
      color: var(--primary);
      margin: 24px 0 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e0e6da;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-weight: 600;
      font-size: 0.95rem;
      margin-bottom: 8px;
      color: #444;
    }

    .unit-hint {
      font-weight: normal;
      font-size: 0.8rem;
      color: #777;
      margin-left: 4px;
    }

    .required::after {
      content: " *";
      color: #c0392b;
    }

    input, select {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 0.95rem;
      transition: all 0.2s;
      background: #fafafa;
      font-family: inherit;
    }

    input:focus, select:focus {
      outline: none;
      border-color: var(--secondary);
      background: #fff;
      box-shadow: 0 0 0 3px rgba(44, 94, 46, 0.15);
    }

    .soil-analysis-box {
      background: #fdfefd;
      border: 1px solid #c8dcc8;
      border-radius: 10px;
      padding: 20px;
      margin-top: 10px;
    }

    .btn-container {
      display: flex;
      gap: 16px;
      margin-top: 24px;
      flex-wrap: wrap;
    }

    button {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      font-size: 1rem;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    button:active {
      transform: translateY(1px);
    }

    .btn-primary {
      background: var(--primary);
      color: white;
      flex: 2;
    }
    
    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-secondary {
      background: #e0e0e0;
      color: #333;
      flex: 1;
    }
    
    .btn-secondary:hover {
      background: #d0d0d0;
    }

    .btn-outline {
      background: transparent;
      border: 1px solid var(--primary);
      color: var(--primary);
    }
    
    .btn-outline:hover {
      background: rgba(44, 94, 46, 0.1);
    }

    .results-area {
      display: none;
      background: var(--card-bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 28px;
      margin-top: 24px;
      border: 1px solid var(--border);
      animation: slideDown 0.4s ease-out;
    }

    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .result-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.04);
      margin-bottom: 24px;
    }

    .nutrient-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }

    .nutrient-box {
      text-align: center;
      padding: 20px;
      background: #f8faf8;
      border: 1px solid #eee;
      border-radius: 10px;
      transition: all 0.2s;
    }
    
    .nutrient-box:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .nutrient-val {
      display: block;
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--primary);
      margin: 10px 0;
    }

    .nutrient-label {
      font-size: 1rem;
      color: #555;
      font-weight: 600;
    }

    .analysis-list {
      background: var(--warning);
      border-left: 4px solid var(--accent);
      padding: 20px;
      margin-top: 24px;
      border-radius: 0 10px 10px 0;
    }

    .analysis-list ul {
      margin: 10px 0 0 0;
      padding-left: 20px;
    }
    
    .analysis-list li {
      margin-bottom: 8px;
      line-height: 1.5;
    }

    .balance-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .balance-table th,
    .balance-table td {
      padding: 12px 15px;
      text-align: center;
      border-bottom: 1px solid #eee;
    }
    
    .balance-table th {
      background: var(--primary);
      color: white;
      font-weight: 600;
    }
    
    .balance-table tr:last-child td {
      border-bottom: none;
    }
    
    .balance-table tr:nth-child(even) {
      background-color: #f8faf8;
    }

    .tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    
    .tab {
      padding: 10px 20px;
      background: #e0e6da;
      border-radius: 8px 8px 0 0;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s;
    }
    
    .tab.active {
      background: var(--primary);
      color: white;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }

    .info-box {
      background: #eef5ef;
      border-left: 4px solid var(--accent);
      padding: 16px;
      border-radius: 0 8px 8px 0;
      margin: 16px 0;
      font-size: 0.95rem;
    }

    .footer-note {
      text-align: center;
      margin-top: 24px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
      color: #777;
      font-size: 0.9rem;
    }

    .license-note {
      font-size: 0.85rem;
      color: #555;
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid #eee;
      text-align: center;
    }

    .license-note a {
      color: var(--primary);
      text-decoration: underline;
    }

    @media (max-width: 768px) {
      .grid-container {
        grid-template-columns: 1fr;
      }
      
      .btn-container {
        flex-direction: column;
      }
      
      button {
        width: 100%;
      }
      
      .nutrient-grid {
        grid-template-columns: 1fr;
      }
      
      .author-badge {
        position: static;
        margin-top: 10px;
        text-align: left;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="header-content">
        <div>
          <h1>Επαγγελματικός Υπολογιστής Λίπανσης Ελιάς</h1>
          <div class="subtitle">Ολοκληρωμένο εργαλείο για αγρότες και γεωπόνους | Έκδοση 4.1</div>
        </div>
        <div class="author-badge">Δημιουργός: Sotiris G. Paisios</div>
      </div>
    </header>

    <div class="card">
      <div class="tabs">
        <div class="tab active" data-tab="basic">Βασικά Στοιχεία</div>
        <div class="tab" data-tab="advanced">Προχωρημένες Παράμετροι</div>
      </div>
      
      <form id="calcForm" onsubmit="event.preventDefault(); calculateFertilization();">
        <!-- Basic Tab -->
        <div class="tab-content active" id="basic-tab">
          <h2 class="section-title">1. Φυσιολογία & Σύστημα Καλλιέργειας</h2>
          <div class="grid-container">
            <div class="form-group">
              <label class="required">Τύπος Ελιάς</label>
              <select id="typosElia">
                <option value="">Επιλέξτε...</option>
                <option value="table">Επιτραπέζια</option>
                <option value="oil">Ελαιοποιήσιμη</option>
              </select>
            </div>
            <div class="form-group">
              <label class="required">Σύστημα Καλλιέργειας</label>
              <select id="typosKalliergeias">
                <option value="">Επιλέξτε...</option>
                <option value="ξηρική">Ξηρική (Παραδοσιακή)</option>
                <option value="ποτιστική">Ποτιστική</option>
                <option value="εντατική">Εντατική / Υπέρπυκνη</option>
              </select>
            </div>
            <div class="form-group">
              <label class="required">Βιολογική Καλλιέργεια</label>
              <select id="viologiki">
                <option value="οχι">Όχι</option>
                <option value="ναι">Ναι</option>
              </select>
            </div>
            <div class="form-group">
              <label class="required">Ηλικία Δέντρων (Έτη)</label>
              <input type="number" id="ilikia" value="15" min="1">
            </div>
            <div class="form-group">
              <label class="required">Διάμετρος Κορμού <span class="unit-hint">(cm)</span></label>
              <input type="number" id="diametros" placeholder="π.χ. 25" min="1">
            </div>
            <div class="form-group">
              <label class="required">Πυκνότητα <span class="unit-hint">(δέντρα/στρ)</span></label>
              <input type="number" id="pyknotita" value="20" min="1">
            </div>
          </div>

          <h2 class="section-title">2. Εδαφολογικά Χαρακτηριστικά</h2>
          <div class="grid-container">
            <div class="form-group">
              <label class="required">Μηχανική Σύσταση</label>
              <select id="edafos">
                <option value="">Επιλέξτε...</option>
                <option value="ελαφρυ">Ελαφρύ (Αμμώδες)</option>
                <option value="μεσαίο">Μεσαίο (Πηλώδες)</option>
                <option value="βαρύ">Βαρύ (Αργιλώδες)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="required">Συνθήκες Stress</label>
              <select id="stress">
                <option value="κανονικές">Κανονικές</option>
                <option value="ξηρασία">Ξηρασία</option>
                <option value="παγετός">Παγετός</option>
                <option value="αλμυρότητα">Αλμυρότητα</option>
              </select>
            </div>
            <div class="form-group">
              <label>Οργανική Ουσία <span class="unit-hint">(%)</span></label>
              <input type="number" id="om" placeholder="π.χ. 1.2" step="0.1">
            </div>
            <div class="form-group">
              <label>pH Εδάφους</label>
              <input type="number" id="ph" placeholder="π.χ. 7.5" step="0.1" min="4" max="10">
            </div>
            <div class="form-group">
              <label>Εφαρμογή Κοπριάς/Κομπόστ;</label>
              <select id="kompost">
                <option value="οχι">Όχι</option>
                <option value="ναι">Ναι</option>
              </select>
            </div>
          </div>

          <div class="info-box">
            <strong>Συμβουλή:</strong> Για πιο ακριβείς υπολογισμούς, συμπληρώστε την ανάλυση εδάφους στην καρτέλα "Προχωρημένες Παράμετροι".
          </div>
        </div>

        <!-- Advanced Tab -->
        <div class="tab-content" id="advanced-tab">
          <h2 class="section-title">3. Χημική Ανάλυση Εδάφους</h2>
          <div class="soil-analysis-box grid-container">
            <div class="form-group">
              <label>Άζωτο (N) <span class="unit-hint">(ppm)</span></label>
              <input type="number" id="soilN" placeholder="Ανόργανο N" step="0.1">
            </div>
            <div class="form-group">
              <label>Φώσφορος (P) <span class="unit-hint">(ppm Olsen)</span></label>
              <input type="number" id="soilP" placeholder="Διαθέσιμος P" step="0.1">
            </div>
            <div class="form-group">
              <label>Κάλιο (K) <span class="unit-hint">(ppm)</span></label>
              <input type="number" id="soilK" placeholder="Εναλλάξιμο K" step="0.1">
            </div>
            <div class="form-group">
              <label>Μαγνήσιο (Mg) <span class="unit-hint">(ppm)</span></label>
              <input type="number" id="soilMg" placeholder="Εναλλάξιμο Mg" step="0.1">
            </div>
            <div class="form-group">
              <label>Βόριο (B) <span class="unit-hint">(ppm)</span></label>
              <input type="number" id="soilB" placeholder="Διαθέσιμο B" step="0.01">
            </div>
            <div class="form-group" style="background: #fff8e1; border:1px solid #ffe082; padding:10px; border-radius:8px;">
              <label>Ολικό CaCO₃ <span class="unit-hint">(%)</span></label>
              <input type="number" id="caco3" placeholder="Ανθρακικό Ασβέστιο" step="0.1" min="0" max="100">
            </div>
          </div>

          <h2 class="section-title">4. Παράμετροι Αποδοτικότητας</h2>
          <div class="grid-container">
            <div class="form-group">
              <label>Αποδοτικότητα Αζώτου (η<sub>N</sub>)</label>
              <input type="number" id="etaN" value="0.6" min="0" max="1" step="0.01">
              <div class="unit-hint">Τυπική τιμή: 0.6</div>
            </div>
            <div class="form-group">
              <label>Αποδοτικότητα Φωσφόρου (η<sub>P</sub>)</label>
              <input type="number" id="etaP" value="0.7" min="0" max="1" step="0.01">
              <div class="unit-hint">Τυπική τιμή: 0.7</div>
            </div>
            <div class="form-group">
              <label>Αποδοτικότητα Καλίου (η<sub>K</sub>)</label>
              <input type="number" id="etaK" value="0.7" min="0" max="1" step="0.01">
              <div class="unit-hint">Τυπική τιμή: 0.7</div>
            </div>
            <div class="form-group">
              <label>Αποδοτικότητα Μαγνησίου (η<sub>Mg</sub>)</label>
              <input type="number" id="etaMg" value="0.7" min="0" max="1" step="0.01">
              <div class="unit-hint">Τυπική τιμή: 0.7</div>
            </div>
            <div class="form-group">
              <label>Αποδοτικότητα Βορίου (η<sub>B</sub>)</label>
              <input type="number" id="etaB" value="0.5" min="0" max="1" step="0.01">
              <div class="unit-hint">Τυπική τιμή: 0.5</div>
            </div>
          </div>

          <h2 class="section-title">5. Σύνθεση Λιπάσματος</h2>
          <div class="grid-container">
            <div class="form-group">
              <label>% N (Άζωτο)</label>
              <input type="number" id="fertPercentN" value="0" min="0" step="0.1">
            </div>
            <div class="form-group">
              <label>% P₂O₅ (Φωσφόρος)</label>
              <input type="number" id="fertPercentP" value="0" min="0" step="0.1">
            </div>
            <div class="form-group">
              <label>% K₂O (Κάλιο)</label>
              <input type="number" id="fertPercentK" value="0" min="0" step="0.1">
            </div>
            <div class="form-group">
              <label>% MgO (Μαγνήσιο)</label>
              <input type="number" id="fertPercentMg" value="0" min="0" step="0.1">
            </div>
            <div class="form-group">
              <label>% B (Βόριο)</label>
              <input type="number" id="fertPercentB" value="0" min="0" step="0.001">
            </div>
          </div>
        </div>

        <div class="btn-container">
          <button type="submit" class="btn-primary">Υπολογισμός Λίπανσης</button>
          <button type="button" class="btn-secondary" onclick="resetForm()">Καθαρισμός</button>
          <button type="button" class="btn-outline" id="toggleAdvanced">Προχωρημένες Ρυθμίσεις</button>
        </div>
      </form>
    </div>

    <div class="results-area" id="results">
      <h2 class="section-title">Πρόταση Λίπανσης</h2>
      
      <div class="result-card">
        <div class="nutrient-grid">
          <div class="nutrient-box">
            <span class="nutrient-label">Άζωτο (N)</span>
            <span class="nutrient-val" id="resN">-</span>
            <div class="unit-hint">kg/στρ.</div>
          </div>
          <div class="nutrient-box">
            <span class="nutrient-label">Φωσφόρος (P₂O₅)</span>
            <span class="nutrient-val" id="resP">-</span>
            <div class="unit-hint">kg/στρ.</div>
          </div>
          <div class="nutrient-box">
            <span class="nutrient-label">Κάλιο (K₂O)</span>
            <span class="nutrient-val" id="resK">-</span>
            <div class="unit-hint">kg/στρ.</div>
          </div>
          <div class="nutrient-box">
            <span class="nutrient-label">Μαγνήσιο (MgO)</span>
            <span class="nutrient-val" id="resMg">-</span>
            <div class="unit-hint">kg/στρ.</div>
          </div>
          <div class="nutrient-box">
            <span class="nutrient-label">Βόριο (B)</span>
            <span class="nutrient-val" id="resB">-</span>
            <div class="unit-hint">kg/στρ.</div>
          </div>
        </div>
        
        <div class="balance-table" id="balanceTable">
          <table>
            <thead>
              <tr>
                <th>Στοιχείο</th>
                <th>Απαιτήσεις<br>(kg/στρ.)</th>
                <th>Προσφορά<br>(kg/στρ.)</th>
                <th>Λίπανση<br>(kg/στρ.)</th>
                <th>Δόση Λιπάσματος<br>(kg/στρ.)</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>N</td>
                <td id="reqN">-</td>
                <td id="supplyN">-</td>
                <td id="fertN">-</td>
                <td id="doseN">-</td>
              </tr>
              <tr>
                <td>P₂O₅</td>
                <td id="reqP">-</td>
                <td id="supplyP">-</td>
                <td id="fertP">-</td>
                <td id="doseP">-</td>
              </tr>
              <tr>
                <td>K₂O</td>
                <td id="reqK">-</td>
                <td id="supplyK">-</td>
                <td id="fertK">-</td>
                <td id="doseK">-</td>
              </tr>
              <tr>
                <td>MgO</td>
                <td id="reqMg">-</td>
                <td id="supplyMg">-</td>
                <td id="fertMg">-</td>
                <td id="doseMg">-</td>
              </tr>
              <tr>
                <td>B</td>
                <td id="reqB">-</td>
                <td id="supplyB">-</td>
                <td id="fertB">-</td>
                <td id="doseB">-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div id="diagnosticBox" class="analysis-list" style="display:none;">
        <strong>Διάγνωση & Προτάσεις:</strong>
        <ul id="diagnosticList"></ul>
      </div>
    </div>

    <div class="footer-note">
      * Οι τιμές αφορούν καθαρές μονάδες θρεπτικών στοιχείων ανά στρέμμα. 
      Το εργαλείο βασίζεται σε επιστημονικά δεδομένα και πρακτική εμπειρία.
    </div>

    <div class="license-note">
      © 2026 Sotiris G. Paisios. Διατίθεται υπό την άδεια 
      <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>.<br>
      Επιτρέπεται η ελεύθερη χρήση και διανομή για μη εμπορικούς σκοπούς, 
      με αναφορά στον δημιουργό. Απαγορεύεται η εμπορική εκμετάλλευση.
    </div>
  </div>

  <script>
    // Υπολογισμός λίπανσης ελιάς - Δημιουργός: Sotiris G. Paisios, 2026
    // Εργαλείο για την ελληνική αγροτική κοινότητα - Απαγορεύεται η εμπορική χρήση
    // Άδεια: CC BY-NC-SA 4.0

    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        const tabId = tab.getAttribute('data-tab');
        document.getElementById(`${tabId}-tab`).classList.add('active');
      });
    });
    
    document.getElementById('toggleAdvanced').addEventListener('click', () => {
      const advancedTab = document.getElementById('advanced-tab');
      if (advancedTab.classList.contains('active')) {
        document.querySelector('.tab[data-tab="basic"]').click();
      } else {
        document.querySelector('.tab[data-tab="advanced"]').click();
      }
    });

    function calculateFertilization() {
      const typosElia = document.getElementById("typosElia").value;
      const typosKalliergeias = document.getElementById("typosKalliergeias").value;
      const viologiki = document.getElementById("viologiki").value;
      const ilikia = parseFloat(document.getElementById("ilikia").value) || 0;
      const diametros = parseFloat(document.getElementById("diametros").value) || 0;
      const pyknotita = parseFloat(document.getElementById("pyknotita").value) || 0;
      
      const edafos = document.getElementById("edafos").value;
      const stress = document.getElementById("stress").value;
      const ph = parseFloat(document.getElementById("ph").value);
      const caco3 = parseFloat(document.getElementById("caco3").value);
      const om = parseFloat(document.getElementById("om").value);
      const kompost = document.getElementById("kompost").value;
      
      const soilN = parseFloat(document.getElementById("soilN").value) || 0;
      const soilP = parseFloat(document.getElementById("soilP").value) || 0;
      const soilK = parseFloat(document.getElementById("soilK").value) || 0;
      const soilMg = parseFloat(document.getElementById("soilMg").value) || 0;
      const soilB = parseFloat(document.getElementById("soilB").value) || 0;
      
      const etaN = parseFloat(document.getElementById("etaN").value) || 0.6;
      const etaP = parseFloat(document.getElementById("etaP").value) || 0.7;
      const etaK = parseFloat(document.getElementById("etaK").value) || 0.7;
      const etaMg = parseFloat(document.getElementById("etaMg").value) || 0.7;
      const etaB = parseFloat(document.getElementById("etaB").value) || 0.5;
      
      const fertPercentN = parseFloat(document.getElementById("fertPercentN").value) || 0;
      const fertPercentP = parseFloat(document.getElementById("fertPercentP").value) || 0;
      const fertPercentK = parseFloat(document.getElementById("fertPercentK").value) || 0;
      const fertPercentMg = parseFloat(document.getElementById("fertPercentMg").value) || 0;
      const fertPercentB = parseFloat(document.getElementById("fertPercentB").value) || 0;

      if(!typosElia || !typosKalliergeias || !edafos || !diametros || !pyknotita) {
        alert("Συμπληρώστε τα υποχρεωτικά πεδία (Τύπος, Σύστημα, Έδαφος, Διάμετρος, Πυκνότητα).");
        return;
      }

      let baseN = 8, baseP = 4, baseK = 10, baseMg = 2, baseB = 0.08;

      if (typosElia === 'table') { 
        baseN += 1; 
        baseK += 2; 
        baseMg += 0.5;
      }
      if (typosElia === 'oil') { 
        baseK += 2; 
        baseMg += 0.3;
      }

      let sizeFactor = 1.0;
      if (diametros < 10) sizeFactor = 0.5;
      else if (diametros < 20) sizeFactor = 0.8;
      else if (diametros < 35) sizeFactor = 1.0;
      else if (diametros < 50) sizeFactor = 1.25;
      else sizeFactor = 1.4;

      baseN *= sizeFactor; 
      baseP *= sizeFactor; 
      baseK *= sizeFactor;
      baseMg *= sizeFactor;
      baseB *= sizeFactor;

      if (typosKalliergeias === 'ποτιστική') { 
        baseN += 2; 
        baseK += 2; 
        baseMg += 0.5;
      }
      if (typosKalliergeias === 'εντατική') { 
        baseN += 4; 
        baseP += 1; 
        baseK += 4; 
        baseMg += 1;
      }

      if (edafos === 'ελαφρυ') { 
        baseN *= 1.2; 
        baseK *= 1.15; 
        baseMg *= 1.1;
      }
      if (edafos === 'βαρύ') { 
        baseN *= 0.95; 
        baseK *= 0.9; 
        baseMg *= 0.95;
      }

      let notes = [];
      
      if (!isNaN(caco3)) {
        if (caco3 >= 15 && caco3 < 40) {
          baseP *= 1.15; 
          baseK *= 1.1;
          baseMg *= 1.05;
          notes.push(`CaCO₃ (${caco3}%): Υψηλό. Αυξήθηκε το P, K και Mg λόγω δέσμευσης/ανταγωνισμού.`);
          notes.push(`Σύσταση: Χρήση όξινων μορφών (π.χ. θειική αμμωνία) και χηλικό σίδηρο.`);
        } else if (caco3 >= 40) {
          baseP *= 1.3;
          baseK *= 1.2;
          baseMg *= 1.1;
          notes.push(`CaCO₃ (${caco3}%): ΑΚΡΑΙΑ ΥΨΗΛΟ. Μεγάλος κίνδυνος χλώρωσης και ακινητοποίησης P.`);
          notes.push(`Σύσταση: Αποφυγή αμμωνιακών επιφανειακά. Απαραίτητη διαφυλλική υποστήριξη.`);
        }
      }

      if (!isNaN(ph)) {
        if (ph > 8.0) {
          notes.push(`pH (${ph}): Αλκαλικό. Προσοχή στη διαθεσιμότητα ιχνοστοιχείων (Fe, Zn, Mn).`);
        }
        if (ph < 5.5) {
          notes.push(`pH (${ph}): Όξινο. Πιθανή τοξικότητα Αλουμινίου/Μαγγανίου.`);
        }
      }

      if (kompost === 'ναι') { 
        baseN -= 2; 
        baseP -= 1; 
        baseK -= 2; 
        baseMg -= 0.5;
      }
      if (viologiki === 'ναι') { 
        baseN *= 0.9; 
        baseP *= 0.95; 
        baseK *= 0.95;
      }

      const densityScale = pyknotita / 20;
      baseN *= densityScale; 
      baseP *= densityScale; 
      baseK *= densityScale;
      baseMg *= densityScale;
      baseB *= densityScale;

      if (stress === 'ξηρασία') {
        baseN *= 0.85;
        baseK *= 1.1;
        notes.push("Stress ξηρασίας: Μείωση N και αύξηση K για βελτίωση αντοχής.");
      }
      if (stress === 'παγετός') {
        baseK *= 1.2;
        notes.push("Stress παγετού: Αύξηση K για βελτίωση αντοχής.");
      }
      if (stress === 'αλμυρότητα') {
        baseK *= 0.8;
        notes.push("Stress αλμυρότητας: Μείωση K για ισορροπία.");
      }

      let reqN = Math.max(0, baseN);
      let reqP = Math.max(0, baseP);
      let reqK = Math.max(0, baseK);
      let reqMg = Math.max(0, baseMg);
      let reqB = Math.max(0, baseB);

      let supplyN = soilN * 0.1;
      let supplyP = soilP * 0.1;
      let supplyK = soilK * 0.1;
      let supplyMg = soilMg * 0.1;
      let supplyB = soilB;

      let fertN = Math.max(0, reqN - supplyN);
      let fertP = Math.max(0, reqP - supplyP);
      let fertK = Math.max(0, reqK - supplyK);
      let fertMg = Math.max(0, reqMg - supplyMg);
      let fertB = Math.max(0, reqB - supplyB);

      let doseN = fertPercentN > 0 ? (fertN / (fertPercentN / 100)) : (fertN > 0 ? "Χρειάζεται λίπασμα N" : "-");
      let doseP = fertPercentP > 0 ? (fertP / (fertPercentP / 100)) : (fertP > 0 ? "Χρειάζεται λίπασμα P" : "-");
      let doseK = fertPercentK > 0 ? (fertK / (fertPercentK / 100)) : (fertK > 0 ? "Χρειάζεται λίπασμα K" : "-");
      let doseMg = fertPercentMg > 0 ? (fertMg / (fertPercentMg / 100)) : (fertMg > 0 ? "Χρειάζεται λίπασμα Mg" : "-");
      let doseB = fertPercentB > 0 ? (fertB / (fertPercentB / 100)) : (fertB > 0 ? "Χρειάζεται λίπασμα B" : "-");

      const formatDose = (dose) => {
        if (typeof dose === 'string') return dose;
        return dose > 0 ? dose.toFixed(1) : "-";
      };

      document.getElementById('resN').innerText = fertN.toFixed(1);
      document.getElementById('resP').innerText = fertP.toFixed(1);
      document.getElementById('resK').innerText = fertK.toFixed(1);
      document.getElementById('resMg').innerText = fertMg.toFixed(1);
      document.getElementById('resB').innerText = fertB.toFixed(2);
      
      document.getElementById('reqN').innerText = reqN.toFixed(1);
      document.getElementById('reqP').innerText = reqP.toFixed(1);
      document.getElementById('reqK').innerText = reqK.toFixed(1);
      document.getElementById('reqMg').innerText = reqMg.toFixed(1);
      document.getElementById('reqB').innerText = reqB.toFixed(2);
      
      document.getElementById('supplyN').innerText = supplyN.toFixed(1);
      document.getElementById('supplyP').innerText = supplyP.toFixed(1);
      document.getElementById('supplyK').innerText = supplyK.toFixed(1);
      document.getElementById('supplyMg').innerText = supplyMg.toFixed(1);
      document.getElementById('supplyB').innerText = supplyB.toFixed(2);
      
      document.getElementById('fertN').innerText = fertN.toFixed(1);
      document.getElementById('fertP').innerText = fertP.toFixed(1);
      document.getElementById('fertK').innerText = fertK.toFixed(1);
      document.getElementById('fertMg').innerText = fertMg.toFixed(1);
      document.getElementById('fertB').innerText = fertB.toFixed(2);
      
      document.getElementById('doseN').innerText = formatDose(doseN);
      document.getElementById('doseP').innerText = formatDose(doseP);
      document.getElementById('doseK').innerText = formatDose(doseK);
      document.getElementById('doseMg').innerText = formatDose(doseMg);
      document.getElementById('doseB').innerText = formatDose(doseB);

      const list = document.getElementById('diagnosticList');
      list.innerHTML = "";
      
      if (supplyMg > reqMg) {
        notes.push(`MgO: Πλεόνασμα στο έδαφος (${supplyMg.toFixed(1)} > ${reqMg.toFixed(1)} kg/στρ.). Δεν απαιτείται λίπανση.`);
      }
      if (supplyB > reqB) {
        notes.push(`B: Πλεόνασμα στο έδαφος (${supplyB.toFixed(2)} > ${reqB.toFixed(2)} kg/στρ.). Δεν απαιτείται λίπανση.`);
      }
      
      if (notes.length > 0 || stress !== 'κανονικές') {
        document.getElementById('diagnosticBox').style.display = 'block';
        
        if (stress !== 'κανονικές') {
          notes.unshift(`Stress: ${stress.toUpperCase()} - Λήφθηκε υπόψη.`);
        }
        
        notes.forEach(note => {
          const li = document.createElement('li');
          li.innerText = note;
          list.appendChild(li);
        });
      } else {
        document.getElementById('diagnosticBox').style.display = 'none';
      }

      document.getElementById('results').style.display = 'block';
      document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
    }

    function resetForm() {
      document.getElementById('calcForm').reset();
      document.getElementById('results').style.display = 'none';
      document.getElementById('etaN').value = '0.6';
      document.getElementById('etaP').value = '0.7';
      document.getElementById('etaK').value = '0.7';
      document.getElementById('etaMg').value = '0.7';
      document.getElementById('etaB').value = '0.5';
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('etaN').value = '0.6';
      document.getElementById('etaP').value = '0.7';
      document.getElementById('etaK').value = '0.7';
      document.getElementById('etaMg').value = '0.7';
      document.getElementById('etaB').value = '0.5';
    });
  </script>
</body>
</html>